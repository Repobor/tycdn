import{c as W,m as X,d as Y,e as Z,o as q,b as ee,p as le,f as te,g as ae,q as oe,h as ue,i as ne,E as se}from"./element-plus.254419c7.js";import{D as ie,r as u,c as C,S as l,Q as t,a as y,u as re,o as i,M as U,a4 as $,P as F,T as de,a5 as s}from"./@vue.a9411cd4.js";import{C as z}from"./comments.acbe1280.js";import{U as P}from"./index.df009344.js";import{F as me}from"./films.1ceea531.js";import"./dayjs.ba0a1193.js";import"./clone-deep.292945d4.js";import"./shallow-clone.95d3ae69.js";import"./kind-of.db8547f8.js";import"./is-plain-object.c8a6e606.js";import"./isobject.b90498ab.js";import"./@element-plus.d7dd3bba.js";import"./lodash-es.f14d6700.js";import"./@vueuse.8f037a30.js";import"./async-validator.ca741037.js";import"./@sxzz.30ebe6b1.js";import"./escape-html.10c6516a.js";import"./normalize-wheel-es.65bdcd5b.js";import"./@ctrl.70544517.js";import"./pinia.27fdb009.js";import"./vue-demi.237d1bfa.js";import"./vue3-lazyload.76288b1e.js";import"./vue-router.f1a6a0d1.js";import"./nprogress.f46f69d2.js";import"./axios.3a678d80.js";import"./form-data.18640493.js";import"./theme-change.990675dd.js";const pe={class:"dialog-footer"},ce=s("\u53D6\u6D88"),ve=s(" \u786E\u8BA4 "),_e={id:"control",class:"mb-2"},fe=s(" \u91CD\u7F6E "),ge=s(" \u6B63\u5E38 "),he=s(" \u7981\u7528 "),be=s(" \u901A\u8FC7 "),ke=y("p",null,"\u786E\u8BA4\u5220\u9664\uFF1F",-1),Ce={style:{"text-align":"center",margin:"0"}},Fe=s(" \u5426 "),ye=s(" \u662F "),Ee=s(" \u5220\u9664 "),qe=ie({__name:"index",setup(Be){const g=u(""),E=u(""),n=u(),r=u(1),v=u(20),S=u(0),h=u(!1),_=u({}),m=u([!1]),p=o=>{r.value=o,z.getList(r.value,v.value,g.value,E.value,-2).then(({data:a})=>{n.value=a.list,m.value=new Array(50).fill(!1),a.total&&(S.value=a.total),n.value.forEach(b=>{P.getUserById(b.user_id).then(k=>{b.username=k.data.username})})})};p(1);const A=()=>{r.value=1,v.value=20,n.value=[],p(1)},M=o=>{m.value=new Array(50).fill(!1),v.value=o,r.value=1,p(1)},L=()=>{r.value=1,v.value=20,g.value="",n.value=[],p(1)},N=o=>{z.del(n.value[o].id).then(()=>{n.value.splice(o,1)})},f=u(!1),B=u(),I=u(!1),V=u(),O=o=>{o?(f.value=!0,setTimeout(()=>{f.value=!1,P.getList(1,50,0,o).then(({data:a})=>V.value=a.list)},200)):V.value=[]},H=o=>{n.value[o].status=2,z.put(n.value[o]).then(()=>{se({message:"\u5DF2\u901A\u8FC7",type:"success"}),h.value=!1}).finally(()=>{p(r.value)})},Q=o=>{o?(f.value=!0,setTimeout(()=>{f.value=!1,me.getList(1,50,void 0,void 0,void 0,o,void 0,1).then(({data:a})=>B.value=a.list)},200)):B.value=[]},j=[{value:2,label:"\u6B63\u5E38"},{value:-2,label:"\u672A\u901A\u8FC7"}];return(o,a)=>{const b=W,k=X,w=Y,x=Z,G=q,d=ee,J=le,c=te,T=ae,K=oe,R=ue;return i(),C("div",null,[l(J,{modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=e=>h.value=e),title:"Editor",draggable:!1,top:"12vh"},{footer:t(()=>[y("span",pe,[l(d,{onClick:a[2]||(a[2]=e=>h.value=!1)},{default:t(()=>[ce]),_:1}),l(d,{type:"primary",onClick:o.dialogSubmit},{default:t(()=>[ve]),_:1},8,["onClick"])])]),default:t(()=>[l(G,{model:_.value},{default:t(()=>[l(k,{label:"\u5185\u5BB9"},{default:t(()=>[l(b,{modelValue:_.value.content,"onUpdate:modelValue":a[0]||(a[0]=e=>_.value.content=e),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(k,{label:"\u72B6\u6001"},{default:t(()=>[l(x,{modelValue:_.value.status,"onUpdate:modelValue":a[1]||(a[1]=e=>_.value.status=e),placeholder:"Select"},{default:t(()=>[(i(),C(U,null,$(j,e=>l(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),y("div",_e,[l(x,{modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=e=>g.value=e),filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u8F93\u5165\u7535\u5F71\u540D\u79F0","remote-show-suffix":"","remote-method":Q,loading:f.value,onChange:A},{default:t(()=>[(i(!0),C(U,null,$(B.value,e=>(i(),F(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l(x,{class:"ml-4",modelValue:E.value,"onUpdate:modelValue":a[5]||(a[5]=e=>E.value=e),filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D","remote-show-suffix":"","remote-method":O,loading:I.value,onChange:A},{default:t(()=>[(i(!0),C(U,null,$(V.value,e=>(i(),F(w,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l(d,{class:"ml-2",type:"primary",onClick:L},{default:t(()=>[fe]),_:1})]),l(re(ne),{"row-key":"id",data:n.value,class:"w-full mt-1",height:"760"},{default:t(()=>[l(c,{prop:"username",label:"\u7528\u6237"}),l(c,{prop:"film_name",label:"\u7535\u5F71\u540D"}),l(c,{prop:"remark",label:"\u8BC4\u5206",width:"110"}),l(c,{prop:"content",label:"\u5185\u5BB9"}),l(c,{prop:"status",label:"\u72B6\u6001",width:"110",sortable:""},{default:t(e=>[e.row.status===2?(i(),F(T,{key:0,type:"success"},{default:t(()=>[ge]),_:1})):(i(),F(T,{key:1,type:"danger"},{default:t(()=>[he]),_:1}))]),_:1}),l(c,{fixed:"right",label:"\u64CD\u4F5C",width:"160"},{default:t(e=>[l(d,{link:"",type:"primary",onClick:de(D=>H(e.$index),["prevent"])},{default:t(()=>[be]),_:2},1032,["onClick"]),l(K,{visible:m.value[e.$index],placement:"top",trigger:"click"},{reference:t(()=>[l(d,{link:"",type:"danger",onClick:D=>m.value[e.$index]=!0},{default:t(()=>[Ee]),_:2},1032,["onClick"])]),default:t(()=>[ke,y("div",Ce,[l(d,{size:"small",text:"",type:"primary",onClick:D=>{m.value[e.$index]=!1}},{default:t(()=>[Fe]),_:2},1032,["onClick"]),l(d,{size:"small",text:"",onClick:D=>{m.value[e.$index]=!1,N(e.$index)}},{default:t(()=>[ye]),_:2},1032,["onClick"])])]),_:2},1032,["visible"])]),_:1})]),_:1},8,["data"]),l(R,{"current-page":r.value,layout:"sizes, prev, pager, next",total:S.value,class:"float-right mt-2",background:"","hide-on-single-page":"","page-sizes":[20,30,50],"page-size":v.value,"onUpdate:currentPage":p,"onUpdate:pageSize":M},null,8,["current-page","total","page-size"])])}}});export{qe as default};
